name: 02-Deploy Travel Solution
# Deploy travelsolution to TEST and PRODUCTION environments
# Triggers when travelsolution is updated or manually

on:
  workflow_dispatch:
  push:
    branches: [main]
    paths: 
      - 'solutions/travelsolution/**'
  release:
    types: [created]

permissions:
  contents: write

jobs:
  deploy-travel-solution:
    uses: ./.github/workflows/shared-deployment-pipeline.yml
    with:
      solution_name: travelsolution
      BUILD_ENVIRONMENT_URL: ${{ vars.BUILD_ENVIRONMENT_URL }}
      TEST_ENVIRONMENT_URL: ${{ vars.TEST_ENVIRONMENT_URL }}
      PRODUCTION_ENVIRONMENT_URL: ${{ vars.PRODUCTION_ENVIRONMENT_URL }}
      CLIENT_ID: ${{ vars.CLIENT_ID }}
      TENANT_ID: ${{ vars.TENANT_ID }}      
    secrets:
      envSecret: ${{ secrets.PowerPlatformSPN }}
